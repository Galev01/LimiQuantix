# ============================================================================
# Quantix-OS initramfs Configuration
# ============================================================================
# Features to include in the initramfs for boot
# ============================================================================

# Base features (always needed)
features="ata base cdrom ext4 keymap kms lvm mmc nvme raid scsi squashfs usb virtio xfs"

# Additional modules for virtualization hosts
# These ensure we can boot on any modern hardware

# Kernel modules to include
kernel_modules="
    # Block devices
    ata_piix
    ahci
    nvme
    virtio_blk
    virtio_scsi
    sd_mod
    sr_mod
    
    # USB
    uhci-hcd
    ehci-hcd
    xhci-hcd
    usb-storage
    
    # Filesystems
    squashfs
    overlay
    ext4
    xfs
    vfat
    iso9660
    
    # RAID & LVM
    dm-mod
    dm-crypt
    md-mod
    raid0
    raid1
    raid5
    raid6
    
    # Network (for PXE/iSCSI boot)
    e1000e
    igb
    ixgbe
    i40e
    mlx4_core
    mlx5_core
    virtio_net
    
    # Graphics (for console) - DRM/KMS drivers
    # Core DRM must load first
    drm
    drm_kms_helper
    
    # Virtual GPU drivers (for VMs) - prioritize these
    virtio-gpu
    virtio_gpu
    simpledrm
    bochs-drm
    cirrus
    
    # Physical GPU drivers (for bare metal)
    i915
    amdgpu
    nouveau
    
    # Legacy framebuffer (fallback when KMS unavailable)
    # These create /dev/fb0 without DRM
    efifb
    simplefb
    vesafb
    vga16fb
    uvesafb
"

# Cmdline parameters for squashfs boot
cmdline="ro quiet modloop=/quantix/system.squashfs modules=loop,squashfs,overlay"
